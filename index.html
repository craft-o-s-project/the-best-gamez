<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Best Gamez</title>
<meta name="theme-color" content="#000000">
<style>
:root {
    --bg-primary: #000;
    --bg-secondary: #0a0a0a;
    --bg-card: #111;
    --bg-card-hover: #1a1a1a;
    --text-primary: #fff;
    --text-secondary: #a0a0a0;
    --accent: #6366f1;
    --border: #222;
    --transition: 0.2s ease;
}
* {margin:0; padding:0; box-sizing:border-box;}
body {font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif; background:var(--bg-primary); color:var(--text-primary); min-height:100vh; line-height:1.6;}
header, footer {background: var(--bg-secondary); padding:15px; text-align:center; border-bottom:1px solid var(--border);}
h1 {margin:0;}
main {max-width:1200px; margin:auto; padding:20px;}
.game-grid {display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:16px;}
.game-card {background:var(--bg-card); border-radius:12px; overflow:hidden; cursor:pointer; border:1px solid var(--border); transition:all var(--transition);}
.game-card:hover {transform:translateY(-4px); background:var(--bg-card-hover); border-color:var(--accent);}
.game-thumbnail {width:100%; aspect-ratio:16/10; display:flex; align-items:center; justify-content:center; background:var(--bg-secondary); color:var(--text-secondary);}
.game-thumbnail img {width:100%; height:100%; object-fit:cover;}
.game-info {padding:12px;}
.game-title {font-size:14px; font-weight:600; margin-bottom:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
.game-category {font-size:12px; color:var(--text-secondary);}
.banner-ad {width:100%; text-align:center; margin:12px 0; border:1px solid var(--border); border-radius:8px; padding:8px; background:var(--bg-secondary);}
nav {background:var(--bg-secondary); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:100;}
.nav-container {max-width:1400px; margin:auto; display:flex; justify-content:space-between; align-items:center; padding:0 16px; height:60px;}
.nav-link {color:var(--text-secondary); text-decoration:none; padding:8px 16px; border-radius:6px; transition:all var(--transition);}
.nav-link.active, .nav-link:hover {background:var(--bg-card); color:var(--text-primary);}
.search-input {width:100%; padding:12px; border-radius:12px; border:1px solid var(--border); background:var(--bg-card); color:var(--text-primary);}
.game-modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:1000; flex-direction:column; align-items:center; justify-content:flex-start; overflow:auto;}
.game-modal.active {display:flex;}
.modal-header {width:100%; max-width:1200px; padding:16px; display:flex; justify-content:space-between; align-items:center;}
.modal-title {font-size:18px; font-weight:600;}
.modal-btn {padding:8px 16px; border-radius:6px; border:1px solid var(--border); background:var(--bg-card); color:var(--text-primary); cursor:pointer; margin-left:8px;}
.modal-btn:hover {background:var(--bg-card-hover);}
.modal-btn.close-btn {background:#ef4444; border-color:#ef4444;}
.modal-btn.close-btn:hover {background:#dc2626;}
.game-frame-container {width:100%; max-width:1200px; display:flex; flex-direction:column; padding:0 16px 16px;}
.game-frame {width:100%; height:600px; border:none; border-radius:12px; background:var(--bg-card);}
.loading {display:flex; align-items:center; justify-content:center; padding:48px; color:var(--text-secondary);}
.loading-spinner {width:32px; height:32px; border:3px solid var(--border); border-top-color:var(--accent); border-radius:50%; animation:spin 1s linear infinite; margin-right:12px;}
@keyframes spin {to{transform:rotate(360deg);}}
</style>
</head>
<body>

<nav>
<div class="nav-container">
<a href="#" class="nav-link active" id="nav-games">Games</a>
<a href="#" class="nav-link" id="nav-popular">Popular</a>
</div>
</nav>

<main>
<div class="search-container">
<input type="text" id="search-input" class="search-input" placeholder="Search games...">
</div>

<div id="games-container">
<div class="loading">
<div class="loading-spinner"></div>
<span>Loading games...</span>
</div>
</div>
</main>

<footer>
<p>&copy; 2026 The Best Gamez</p>
</footer>

<!-- Game Modal -->
<div class="game-modal" id="game-modal">
<div class="modal-header">
<span class="modal-title" id="modal-title"></span>
<div>
<button class="modal-btn" id="close-modal">Close âœ•</button>
</div>
</div>

<!-- Top Banner -->
<div class="banner-ad" id="modalTopAd"></div>

<div class="game-frame-container">
<iframe class="game-frame" id="game-frame" allowfullscreen></iframe>
</div>

<!-- Bottom Banner -->
<div class="banner-ad" id="modalBottomAd"></div>
</div>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2658228516202792"
crossorigin="anonymous"></script>

<script>
const GAMES_JSON_URL = '/games.json';
let allGames=[], currentCategory='all', searchQuery='';

const gamesContainer = document.getElementById('games-container');
const searchInput = document.getElementById('search-input');
const gameModal = document.getElementById('game-modal');
const gameFrame = document.getElementById('game-frame');
const modalTitle = document.getElementById('modal-title');
const closeModal = document.getElementById('close-modal');
const modalTopAd = document.getElementById('modalTopAd');
const modalBottomAd = document.getElementById('modalBottomAd');

const testAd = true; // set true for test mode

// Helper: create banner ad element
function createBannerAd(slot) {
    const adDiv = document.createElement('div');
    adDiv.innerHTML = `<ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-2658228516202792"
    data-ad-slot="${slot}"
    data-ad-format="auto"
    data-full-width-responsive="true" ${testAd?'data-adtest="on"':''}></ins>`;
    const script = document.createElement('script');
    script.innerHTML = '(adsbygoogle = window.adsbygoogle || []).push({});';
    adDiv.appendChild(script);
    return adDiv;
}

// Fetch games.json
async function fetchGames(){
    try{
        const res=await fetch(GAMES_JSON_URL);
        const data=await res.json();
        allGames=data.games||[];
        renderGames();
    }catch(e){
        gamesContainer.innerHTML="<p style='color:var(--text-secondary);text-align:center;padding:40px;'>Failed to load games.json</p>";
    }
}

// Render game grid with ad every 3 rows
function renderGames(){
    if(!allGames.length){
        gamesContainer.innerHTML="<p style='color:var(--text-secondary);text-align:center;padding:40px;'>No games found</p>";
        return;
    }

    const columns = Math.floor(gamesContainer.clientWidth / 180) || 3;
    const gamesPerAd = columns*3; // insert ad every 3 full rows

    let html='<div class="game-grid">';
    allGames.forEach((game,index)=>{
        const thumb = game.image || game.url ? `<img src="${game.url.replace('index.html','thumb.png')}" alt="${game.text}">` : `<span>${game.text[0]}</span>`;
        html+=`<div class="game-card" data-url="${game.url}" data-title="${game.text}">
        <div class="game-thumbnail">${thumb}</div>
        <div class="game-info">
            <div class="game-title">${game.text}</div>
        </div></div>`;
        if((index+1)%gamesPerAd===0) html+=`<div class="banner-ad" style="height:90px;">Banner</div>`;
    });
    html+='</div>';
    gamesContainer.innerHTML=html;

    // add click listeners
    document.querySelectorAll('.game-card').forEach(card=>{
        card.addEventListener('click',()=>openGame(card.dataset.url,card.dataset.title));
    });
}

// Open game modal
function openGame(url,title){
    modalTitle.textContent=title;
    gameFrame.src=url;
    gameModal.classList.add('active');
    document.body.style.overflow='hidden';
    modalTopAd.appendChild(createBannerAd('1441397847'));
    modalBottomAd.appendChild(createBannerAd('1441397847'));
}

// Close modal and unload game
function closeGame(){
    gameFrame.src='about:blank';
    modalTopAd.innerHTML='';
    modalBottomAd.innerHTML='';
    gameModal.classList.remove('active');
    document.body.style.overflow='';
}

closeModal.addEventListener('click',closeGame);
document.addEventListener('keydown',e=>{if(e.key==='Escape') closeGame();});

searchInput.addEventListener('input', e=>{
    searchQuery = e.target.value.toLowerCase();
    const filtered = allGames.filter(g=>g.text.toLowerCase().includes(searchQuery));
    allGames = filtered.length? filtered : allGames;
    renderGames();
});

document.addEventListener('DOMContentLoaded',fetchGames);
</script>
</body>
</html>
